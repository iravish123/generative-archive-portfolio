<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Generative Archive: An Interactive Exploration</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Lora:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f7f2; /* Parchment-like background */
            color: #3a3a3a;
        }
        .font-lora {
            font-family: 'Lora', serif;
        }
        .card {
            background-color: #ffffff;
            border: 1px solid #e2e2e2;
            transition: all 0.3s ease-in-out;
        }
        .card:hover {
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            transform: translateY(-5px);
        }
        .btn-primary {
            background-color: #4a5568; /* Slate 700 */
            color: white;
            transition: background-color 0.3s;
        }
        .btn-primary:hover {
            background-color: #2d3748; /* Slate 800 */
        }
        .btn-primary:disabled {
            background-color: #a0aec0; /* Slate 400 */
            cursor: not-allowed;
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4a5568;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .ethical-footnote {
            background-color: #f8f7f2;
            border-left: 3px solid #718096; /* Slate 500 */
        }
    </style>
</head>
<body class="antialiased">

    <div class="container mx-auto p-4 md:p-8 max-w-6xl">

        <!-- Header -->
        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold font-lora mb-2">The Generative Archive</h1>
            <p class="text-lg text-gray-600">An Interactive Exploration of AI in Cultural Heritage</p>
            <p class="mt-4 max-w-3xl mx-auto text-gray-500">
                Inspired by the principles in <span class="italic">"Navigating Artificial Intelligence for Cultural Heritage Organisations,"</span> this project explores how generative AI can reinterpret and create new entry points into archival collections. It serves as a practical demonstration of the concepts taught in Creative Computing modules.
            </p>
        </header>

        <!-- Main Content Grid -->
        <main class="grid grid-cols-1 md:grid-cols-2 gap-8">

            <!-- Module 1: Converse with the Collection -->
            <section id="converse" class="card rounded-lg p-6 shadow-md">
                <h2 class="text-2xl font-bold font-lora mb-4">1. Converse with the Collection</h2>
                <p class="mb-4 text-gray-600">
                    Engage in a dialogue with our simulated archive. Ask a question about a historical topic, and our AI archivist will synthesize a response based on its vast (simulated) collection of texts. This demonstrates natural language processing and generation.
                </p>
                <div class="space-y-4">
                    <label for="chat-prompt" class="block font-medium text-gray-700">Your Query:</label>
                    <input type="text" id="chat-prompt" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-400" placeholder="e.g., Describe the atmosphere of a 1920s jazz club...">
                    <button id="chat-submit" class="w-full btn-primary font-bold py-3 px-4 rounded-md">
                        Ask the Archive
                    </button>
                </div>
                <div id="chat-loader" class="hidden flex justify-center mt-6">
                    <div class="loader"></div>
                </div>
                <div id="chat-response-area" class="mt-6 hidden">
                    <h3 class="font-bold text-lg mb-2 font-lora">From the Archives:</h3>
                    <div id="chat-response" class="text-gray-700 bg-gray-50 p-4 rounded-md border border-gray-200 whitespace-pre-wrap"></div>
                    <div class="ethical-footnote p-4 mt-4 rounded-md">
                        <p class="font-semibold italic text-gray-800">Curator's Note:</p>
                        <p class="text-sm text-gray-600 mt-1">This response was generated by an AI, not transcribed from a historical document. It synthesizes patterns from vast amounts of text. Consider: How does this affect its authenticity? What voices or perspectives might be amplified or omitted by the underlying data and algorithms?</p>
                    </div>
                </div>
            </section>

            <!-- Module 2: Visualize an Artifact -->
            <section id="visualize" class="card rounded-lg p-6 shadow-md">
                <h2 class="text-2xl font-bold font-lora mb-4">2. Visualize a Speculative Artifact</h2>
                <p class="mb-4 text-gray-600">
                    Archives preserve what was, but what about what could have been? Use our image generation model to create a "speculative artifact" based on a descriptive prompt. This explores the creative potential of generative visual models.
                </p>
                <div class="space-y-4">
                    <label for="image-prompt" class="block font-medium text-gray-700">Artifact Description:</label>
                    <input type="text" id="image-prompt" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-400" placeholder="e.g., A botanist's sketch of a bioluminescent flower...">
                    <button id="image-submit" class="w-full btn-primary font-bold py-3 px-4 rounded-md">
                        Generate Artifact
                    </button>
                </div>
                <div id="image-loader" class="hidden flex justify-center mt-6">
                    <div class="loader"></div>
                </div>
                <div id="image-response-area" class="mt-6 hidden">
                    <h3 class="font-bold text-lg mb-2 font-lora">Generated Artifact:</h3>
                    <div class="bg-gray-100 p-2 rounded-md border border-gray-200">
                        <img id="image-response" src="" alt="Generated artifact" class="w-full h-auto rounded-md object-cover" onerror="this.onerror=null;this.src='https://placehold.co/600x400/f8f7f2/3a3a3a?text=Error+Loading+Image';">
                    </div>
                    <p id="accession-number" class="text-xs text-gray-400 mt-2 text-right"></p>
                    <div class="ethical-footnote p-4 mt-4 rounded-md">
                        <p class="font-semibold italic text-gray-800">Curator's Note:</p>
                        <p class="text-sm text-gray-600 mt-1">This image is an AI's interpretation of your prompt; it is not a scan of a real object. Consider: What does it mean to add new, synthetic items to a historical collection? How do we distinguish between authentic and generated heritage in the digital age?</p>
                    </div>
                </div>
            </section>

        </main>

        <!-- Curator's Notes / About Section -->
        <footer class="mt-16 pt-8 border-t border-gray-300">
            <h2 class="text-2xl font-bold text-center font-lora mb-6">Curator's Notes & Technical Appendix</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 text-gray-600">
                <div>
                    <h3 class="font-bold text-lg font-lora mb-2">Concept & Pedagogy</h3>
                    <p class="mb-4">This application demonstrates proficiency in the core learning outcomes of the Creative Computing modules.
                    <br><br>
                    <strong>For Creative Computing 0:</strong> It showcases fundamental web programming (HTML, CSS, JS), user interactivity, and the use of code for a creative, expressive purposeâ€”generative art and text. The code is structured, commented, and focuses on creating a compelling user experience.
                    <br><br>
                    <strong>For Creative Computing 2:</strong> It directly engages with AI/ML by using large language and image models (via API). It encourages critical reflection on the socio-technical implications of AI, such as authenticity, bias, and the changing nature of cultural archives, which are central themes of the module.
                    </p>
                </div>
                <div>
                    <h3 class="font-bold text-lg font-lora mb-2">Technology Stack</h3>
                    <ul class="list-disc list-inside space-y-2">
                        <li><strong>Frontend:</strong> HTML5, Tailwind CSS for responsive design, and vanilla JavaScript for interactivity and API communication.</li>
                        <li><strong>Interactivity:</strong> DOM manipulation to dynamically display generated content and loading states.</li>
                        <li><strong>Text Generation API:</strong> Asynchronous `fetch` call to Google's Gemini API (`gemini-2.0-flash`) to generate narrative text based on user prompts.</li>
                        <li><strong>Image Generation API:</strong> Asynchronous `fetch` call to Google's Imagen API (`imagen-3.0-generate-002`) to create visual artifacts.</li>
                        <li><strong>Ethical Framework:</strong> The UI incorporates "Curator's Notes" to prompt critical thinking, a key skill for artists and technologists working with AI.</li>
                    </ul>
                </div>
            </div>
        </footer>

    </div>

    <script>
        // --- DOM Element Selection ---
        // A good practice to define all DOM elements at the top for clarity and easy maintenance.
        const chatPrompt = document.getElementById('chat-prompt');
        const chatSubmit = document.getElementById('chat-submit');
        const chatLoader = document.getElementById('chat-loader');
        const chatResponseArea = document.getElementById('chat-response-area');
        const chatResponse = document.getElementById('chat-response');

        const imagePrompt = document.getElementById('image-prompt');
        const imageSubmit = document.getElementById('image-submit');
        const imageLoader = document.getElementById('image-loader');
        const imageResponseArea = document.getElementById('image-response-area');
        const imageResponse = document.getElementById('image-response');
        const accessionNumber = document.getElementById('accession-number');

        // --- API Configuration ---
        // The API Key is intentionally left blank. The execution environment will provide it.
        const apiKey = ""; 

        /**
         * A utility function to toggle the disabled state of buttons and visibility of loaders.
         * This prevents multiple submissions while an API call is in progress.
         * @param {boolean} isLoading - Whether the loading state should be active.
         * @param {HTMLElement} button - The button element to disable/enable.
         * @param {HTMLElement} loader - The loader element to show/hide.
         */
        function setLoadingState(isLoading, button, loader) {
            if (isLoading) {
                button.disabled = true;
                button.classList.add('opacity-50', 'cursor-not-allowed');
                loader.classList.remove('hidden');
            } else {
                button.disabled = false;
                button.classList.remove('opacity-50', 'cursor-not-allowed');
                loader.classList.add('hidden');
            }
        }

        // --- Event Listener for Text Generation ---
        chatSubmit.addEventListener('click', async () => {
            const prompt = chatPrompt.value.trim();
            if (!prompt) {
                alert('Please enter a query for the archive.');
                return;
            }

            // Show loader and disable button
            setLoadingState(true, chatSubmit, chatLoader);
            chatResponseArea.classList.add('hidden');
            
            // This prompt is structured to guide the AI to act as an archivist.
            const fullPrompt = `You are a knowledgeable and slightly formal archivist. Based on a vast collection of historical documents, newspapers, and letters, answer the following user query. Do not say you are an AI. Speak as if you are summarizing findings from physical documents. User query: "${prompt}"`;

            try {
                // Construct the payload for the Gemini API
                const payload = {
                    contents: [{
                        role: "user",
                        parts: [{ text: fullPrompt }]
                    }]
                };

                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                // Make the API call
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const result = await response.json();
                
                // Process and display the response
                if (result.candidates && result.candidates[0].content.parts[0].text) {
                    const text = result.candidates[0].content.parts[0].text;
                    chatResponse.textContent = text;
                    chatResponseArea.classList.remove('hidden');
                } else {
                    throw new Error('Invalid response structure from API.');
                }

            } catch (error) {
                console.error('Error with text generation:', error);
                chatResponse.textContent = 'Sorry, the archive is currently experiencing difficulties. Please try again later.';
                chatResponseArea.classList.remove('hidden');
            } finally {
                // Hide loader and enable button
                setLoadingState(false, chatSubmit, chatLoader);
            }
        });

        // --- Event Listener for Image Generation ---
        imageSubmit.addEventListener('click', async () => {
            const prompt = imagePrompt.value.trim();
            if (!prompt) {
                alert('Please enter a description for the artifact.');
                return;
            }

            // Show loader and disable button
            setLoadingState(true, imageSubmit, imageLoader);
            imageResponseArea.classList.add('hidden');

            try {
                 // Construct the payload for the Imagen API
                const payload = {
                    instances: [{ prompt: prompt }],
                    parameters: { "sampleCount": 1 }
                };
                
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/imagen-3.0-generate-002:predict?key=${apiKey}`;

                // Make the API call
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const result = await response.json();

                // Process and display the response
                if (result.predictions && result.predictions[0].bytesBase64Encoded) {
                    const imageUrl = `data:image/png;base64,${result.predictions[0].bytesBase64Encoded}`;
                    imageResponse.src = imageUrl;
                    // Generate a plausible-looking, random accession number for effect
                    accessionNumber.textContent = `Accession No. GEN-AI-${Math.floor(1000 + Math.random() * 9000)}-${new Date().getFullYear()}`;
                    imageResponseArea.classList.remove('hidden');
                } else {
                    throw new Error('Invalid response structure from API.');
                }

            } catch (error) {
                console.error('Error with image generation:', error);
                imageResponse.src = 'https://placehold.co/600x400/f8f7f2/3a3a3a?text=Generation+Failed';
                accessionNumber.textContent = '';
                imageResponseArea.classList.remove('hidden');
            } finally {
                // Hide loader and enable button
                setLoadingState(false, imageSubmit, imageLoader);
            }
        });

    </script>
</body>
</html>
